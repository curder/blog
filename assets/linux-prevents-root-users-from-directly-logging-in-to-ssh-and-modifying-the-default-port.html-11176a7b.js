import{_ as o,M as d,p as r,q as i,R as e,t as a,N as n,a1 as t}from"./framework-fb0bc66b.js";const l={},c=t(`<h1 id="linux禁止root用户直接登录sshd并修改默认端口" tabindex="-1"><a class="header-anchor" href="#linux禁止root用户直接登录sshd并修改默认端口" aria-hidden="true">#</a> Linux禁止root用户直接登录sshd并修改默认端口</h1><p>Linux最高权限用户<code>root</code>默认可以直接登录ssh。为了提高服务器的安全，将它进行禁止登录，使得攻击者无法通过暴力破解来获取<code>root</code>权限。</p><p>具体操作如下：</p><ol><li><p>新建用户并修改密码 (用户名：<code>newUser</code>、用户密码：<code>newPassword</code>)</p></li><li><p>修改用户sudo权限</p></li><li><p>修改ssh配置，禁止root用户登录和默认登录端口 （新端口：<code>newPort</code>）</p></li><li><p>重启sshd服务</p></li><li><p>尝试登录</p></li></ol><h3 id="新建用户并修改密码" tabindex="-1"><a class="header-anchor" href="#新建用户并修改密码" aria-hidden="true">#</a> 新建用户并修改密码</h3><p><strong>新建用户之前，请切换到root用户再进行如下操作。</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>adduser newUser

<span class="token builtin class-name">echo</span> <span class="token string">&quot;newPassword&quot;</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> newUser
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>newUser</code> 为新建的用户名； <code>newPassword</code> 为新建的用户密码。</p></blockquote><h3 id="添加用户到sudo权限" tabindex="-1"><a class="header-anchor" href="#添加用户到sudo权限" aria-hidden="true">#</a> 添加用户到sudo权限</h3><p>使用命令：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>visudo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在打开的文件中，找到 <code>root ALL=(ALL) ALL</code> 行，在它下面加上：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>newUser ALL=(ALL) ALL 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="修改sshd配置" tabindex="-1"><a class="header-anchor" href="#修改sshd配置" aria-hidden="true">#</a> 修改sshd配置</h3><p>ssh的配置文件在<code>/etc/ssh/sshd_config</code></p><h4 id="禁止root用户直接登录" tabindex="-1"><a class="header-anchor" href="#禁止root用户直接登录" aria-hidden="true">#</a> 禁止root用户直接登录</h4><ol><li>查找<code>“#PermitRootLogin yes</code>，将前面的<code>#</code>去掉，短尾<code>yes</code>改为<code>no</code>，并保存文件。</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>PermitRootLogin no
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>或者使用<strong>sed</strong>命令操作：<code>sed -i &#39;s/#PermitRootLogin yes/PermitRootLogin no/g&#39; /etc/ssh/sshd_config</code></li></ol><h4 id="禁止使用默认22端口" tabindex="-1"><a class="header-anchor" href="#禁止使用默认22端口" aria-hidden="true">#</a> 禁止使用默认22端口</h4><ol><li>找到<code>#Port 22</code>字段删掉<code>#</code>，将<code>22</code>改为其他不被使用的端口，<strong>注意：服务器端口最大可以开到65536</strong></li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Port newPort
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>或者使用<strong>sed</strong>命令操作：<code>sed -i &#39;s/#Port 22/Port newPort/g&#39; /etc/ssh/sshd_config</code></li></ol><h3 id="重启sshd服务" tabindex="-1"><a class="header-anchor" href="#重启sshd服务" aria-hidden="true">#</a> 重启sshd服务</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">service</span> sshd restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p><strong>提醒</strong> 重启sshd服务后切莫退出服务器。使用刚创建的用户成功地通过ssh进入到服务器的测试之后，打开终端的另一个实例，以新建的用户通过ssh进入到服务器并能成功切换到root用户。 要是一切都正常，才可以以root用户身份安全地注销退出服务器。</p></blockquote><h3 id="尝试登录" tabindex="-1"><a class="header-anchor" href="#尝试登录" aria-hidden="true">#</a> 尝试登录</h3><ul><li>root用户使用下面的命令无法登录</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-p</span> newPort root@ip_address
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>普通用户成功登录</li></ul><ol><li>使用下面的ssh命令登录到服务器</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-p</span> newPort newUser@ip_address
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>使用<code>sudo su -</code>输入密码后是否成功登录root用户</li></ol><h2 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接" aria-hidden="true">#</a> 参考链接</h2>`,34),h={href:"https://www.kancloud.cn/curder/linux/202053",target:"_blank",rel:"noopener noreferrer"},u={href:"https://www.centos.bz/2017/12/linuxcentos%E7%A6%81%E6%AD%A2root%E7%94%A8%E6%88%B7%E7%9B%B4%E6%8E%A5%E7%99%BB%E5%BD%95sshd%E5%B9%B6%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3/",target:"_blank",rel:"noopener noreferrer"};function p(g,v){const s=d("ExternalLinkIcon");return r(),i("div",null,[c,e("ul",null,[e("li",null,[e("p",null,[e("a",h,[a("linux禁止root用户直接登录sshd并修改默认端口"),n(s)])])]),e("li",null,[e("p",null,[e("a",u,[a("Linux(centos)禁止root用户直接登录sshd并修改默认端口"),n(s)])])])])])}const m=o(l,[["render",p],["__file","linux-prevents-root-users-from-directly-logging-in-to-ssh-and-modifying-the-default-port.html.vue"]]);export{m as default};
