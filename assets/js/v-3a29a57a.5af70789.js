"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[3494],{6363:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-3a29a57a",path:"/languages/laravel/nova/how-to-use-resources-vilidation-in-laravel-nova.html",title:"使用 laravel nova 验证字段",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"添加字段的验证规则",slug:"添加字段的验证规则",children:[]},{level:2,title:"参考链接",slug:"参考链接",children:[]}],filePathRelative:"languages/laravel/nova/how-to-use-resources-vilidation-in-laravel-nova.md",git:{updatedTime:1640231477e3,contributors:[{name:"curder",email:"q.curder@gmail.com",commits:1}]}}},3603:(n,s,a)=>{a.r(s),a.d(s,{default:()=>h});var t=a(6252);const e=(0,t._)("h1",{id:"使用-laravel-nova-验证字段",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#使用-laravel-nova-验证字段","aria-hidden":"true"},"#"),(0,t.Uk)(" 使用 laravel nova 验证字段")],-1),p=(0,t.Uk)("在"),o={href:"/languages/laravel/nova/how-to-use-resources-relationships-in-laravel-nova.md",target:"_blank",rel:"noopener noreferrer"},l=(0,t.Uk)("使用 laravel nova 关联资源"),c=(0,t.Uk)("中说到使用 nova 定义了一些表之间的关联关系进行一些设定。"),u=(0,t.uE)('<p>在新增和编辑后台资源的时候，会经常使用到一些验证，比如说：字段不允许为空，字段必须是邮箱格式等等。</p><h2 id="添加字段的验证规则" tabindex="-1"><a class="header-anchor" href="#添加字段的验证规则" aria-hidden="true">#</a> 添加字段的验证规则</h2><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token doc-comment comment">/**\n * Get the fields displayed by the resource.\n *\n * <span class="token keyword">@param</span>  <span class="token class-name"><span class="token punctuation">\\</span>Illuminate<span class="token punctuation">\\</span>Http<span class="token punctuation">\\</span>Request</span>  <span class="token parameter">$request</span>\n * <span class="token keyword">@return</span> <span class="token class-name"><span class="token keyword">array</span></span>\n */</span>\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">fields</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">[</span>\n        <span class="token class-name static-context">ID</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">Text</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Title&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 可以使用字符串的形式定义规则</span>\n        <span class="token class-name static-context">Markdown</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Body&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 使用数组形式定义规则</span>\n\n        <span class="token class-name static-context">DateTime</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Publish At&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hideFromIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n            <span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;aftet_or_equal:today&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">DateTime</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Publish Until&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hideFromIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n            <span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;aftet_or_equal:publish_at&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">Boolean</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Active&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;is_published&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">Select</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;category&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n            <span class="token string single-quoted-string">&#39;category-1&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Category One&#39;</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hideWhenUpdating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        <span class="token class-name static-context">BelongsTo</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;User&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        <span class="token class-name static-context">BelongsToMany</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Tags&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>这样，定义的规则在新增和编辑的时候都会生效，如果一些验证规则只需要在<strong>新增</strong>或<strong>编辑</strong>的时候生效，那么需要使用<code>creationRules</code>或<code>updateRules</code></p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token class-name static-context">Text</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Email&#39;</span><span class="token punctuation">)</span>\n    <span class="token operator">-&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;email&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;max:255&#39;</span><span class="token punctuation">)</span>\n    <span class="token operator">-&gt;</span><span class="token function">creationRules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;unique:users,email&#39;</span><span class="token punctuation">)</span>\n    <span class="token operator">-&gt;</span><span class="token function">updateRules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;unique:users,email,{{resourceId}}&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>上面的内容可以参考<code>app\\Nova\\User.php</code>文件中的<code>fields</code>方法中验证规则的定义。</p></blockquote><h2 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接" aria-hidden="true">#</a> 参考链接</h2>',7),r={href:"https://nova.laravel.com/docs/2.0/resources/validation.html#validation",target:"_blank",rel:"noopener noreferrer"},i=(0,t.Uk)("Laravel Nova Validation Rules"),k={href:"https://nova.laravel.com/docs/2.0/resources/validation.html#creation-rules",target:"_blank",rel:"noopener noreferrer"},g=(0,t.Uk)("Laravel Nova Validation Creation Rules"),d={href:"https://nova.laravel.com/docs/2.0/resources/validation.html#update-rules",target:"_blank",rel:"noopener noreferrer"},m=(0,t.Uk)("Laravel Nova Validation Update Rules"),b={},h=(0,a(3744).Z)(b,[["render",function(n,s){const a=(0,t.up)("OutboundLink");return(0,t.wg)(),(0,t.iD)(t.HY,null,[e,(0,t._)("p",null,[p,(0,t._)("a",o,[l,(0,t.Wm)(a)]),c]),u,(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("a",r,[i,(0,t.Wm)(a)])]),(0,t._)("li",null,[(0,t._)("a",k,[g,(0,t.Wm)(a)])]),(0,t._)("li",null,[(0,t._)("a",d,[m,(0,t.Wm)(a)])])])],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}}}]);