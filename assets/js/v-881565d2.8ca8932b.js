(self.webpackChunkblog=self.webpackChunkblog||[]).push([[8893],{8939:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>e});const e={key:"v-881565d2",path:"/languages/laravel/nova/how-to-defining-more-fields-use-laravel-nova.html",title:"使用 laravel nova 定义更多字段",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"给表添加不同类型的列",slug:"给表添加不同类型的列",children:[]},{level:2,title:"添加字段",slug:"添加字段",children:[]},{level:2,title:"字段隐藏",slug:"字段隐藏",children:[{level:3,title:"首页隐藏字段",slug:"首页隐藏字段",children:[]},{level:3,title:"更新页面隐藏字段",slug:"更新页面隐藏字段",children:[]}]},{level:2,title:"参考地址",slug:"参考地址",children:[]}],filePathRelative:"languages/laravel/nova/how-to-defining-more-fields-use-laravel-nova.md",git:{updatedTime:1627991201e3,contributors:[]}}},1093:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>w});var e=a(6252);const p=(0,e.Wm)("h1",{id:"使用-laravel-nova-定义更多字段",tabindex:"-1"},[(0,e.Wm)("a",{class:"header-anchor",href:"#使用-laravel-nova-定义更多字段","aria-hidden":"true"},"#"),(0,e.Uk)(" 使用 laravel nova 定义更多字段")],-1),t=(0,e.Uk)("在"),l={href:"/languages/laravel/nova/how-to-defining-resources-use-laravel-nova.md",target:"_blank",rel:"noopener noreferrer"},o=(0,e.Uk)("使用 laravel nova 定义资源"),c=(0,e.Uk)("中说到使用 nova 定义资源，这里对不同的资源使用不同的类型的列字段。"),i=(0,e.uE)('<h2 id="给表添加不同类型的列" tabindex="-1"><a class="header-anchor" href="#给表添加不同类型的列" aria-hidden="true">#</a> 给表添加不同类型的列</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>php artisan make:migration --table<span class="token operator">=</span>posts add_more_fields_to_posts_table\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>迁移文件的内容如下：</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token doc-comment comment">/**\n * Run the migrations.\n *\n * <span class="token keyword">@return</span> <span class="token class-name"><span class="token keyword">void</span></span>\n */</span>\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;posts&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Blueprint</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">datetime</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;publish_at&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token property">datetim</span><span class="token punctuation">)</span><span class="token punctuation">,</span>publish_until<span class="token string single-quoted-string">&#39;)-&gt;nullable();\n        $table-&gt;boolean(&#39;</span>is_published<span class="token string single-quoted-string">&#39;)-&gt;default(false);  // 自定义数据库字段名\n        $table-&gt;string(&#39;</span>category<span class="token string single-quoted-string">&#39;)-&gt;nullable();\n    });\n}\n\n/**\n    * Reverse the migrations.\n    *\n    * @return void\n    */\npublic function down()\n{\n    Schema::table(&#39;</span>posts<span class="token string single-quoted-string">&#39;, function (Blueprint $table) {\n        $table-&gt;dropColumn([&#39;</span>publish_at<span class="token string single-quoted-string">&#39;, &#39;</span>publish_until<span class="token string single-quoted-string">&#39;, &#39;</span>is_published<span class="token string single-quoted-string">&#39;, &#39;</span>category&#39;<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>执行迁移文件</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>php artisan migrate\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="添加字段" tabindex="-1"><a class="header-anchor" href="#添加字段" aria-hidden="true">#</a> 添加字段</h2><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\\</span>Nova<span class="token punctuation">\\</span>Fields<span class="token punctuation">\\</span>DateTime</span><span class="token punctuation">;</span>\n<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\\</span>Nova<span class="token punctuation">\\</span>Fields<span class="token punctuation">\\</span>Boolean</span><span class="token punctuation">;</span>\n<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\\</span>Nova<span class="token punctuation">\\</span>Fields<span class="token punctuation">\\</span>Select</span><span class="token punctuation">;</span>\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">fields</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">[</span>\n        <span class="token class-name static-context">ID</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">Text</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Title&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">Markdown</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Body&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">rules</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;required&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n        <span class="token class-name static-context">DateTime</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Publish At&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">DateTime</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Publish Until&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">Boolean</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Active&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;is_active&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 自定义数据库字段名</span>\n        <span class="token class-name static-context">Select</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;category&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n            <span class="token string single-quoted-string">&#39;category-1&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Category One&#39;</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div>',8),u=(0,e.Uk)("更多字段可以"),r={href:"https://nova.laravel.com/docs/2.0/resources/fields.html#field-types",target:"_blank",rel:"noopener noreferrer"},k=(0,e.Uk)("查看官方文档"),d=(0,e.uE)('<p>当定义好上面的字段类型后，修改一个文章的<code>Publish At</code>和<code>Publish Until</code>字段，会提示<code>DateTime field must cast to &#39;datetime&#39; in Eloquent model.</code>，错误。</p><p>这是因为我们在模型中定义<code>$casts</code>属性的字段类型。</p><p>修改<code>App\\Post.php</code>模型中的属性值：</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>\n<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Database<span class="token punctuation">\\</span>Eloquent<span class="token punctuation">\\</span>Model</span><span class="token punctuation">;</span>\n<span class="token keyword">class</span> <span class="token class-name-definition class-name">Post</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> <span class="token variable">$casts</span> <span class="token operator">=</span> <span class="token punctuation">[</span>\n        <span class="token string single-quoted-string">&#39;publish_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;datetime&#39;</span><span class="token punctuation">,</span>\n        <span class="token string single-quoted-string">&#39;publish_until&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;datetime&#39;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="字段隐藏" tabindex="-1"><a class="header-anchor" href="#字段隐藏" aria-hidden="true">#</a> 字段隐藏</h2><p>通过修改<code>app\\Nova\\Post.php</code>中的<code>fields</code>方法返回值。</p><h3 id="首页隐藏字段" tabindex="-1"><a class="header-anchor" href="#首页隐藏字段" aria-hidden="true">#</a> 首页隐藏字段</h3><p>默认在文章的列表页将所有的字段都展示出来，这可能不是真实需求，隐藏<code>publish_at</code>和<code>publish_until</code>字段。</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">fields</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">[</span>\n        <span class="token comment">// ...</span>\n        <span class="token class-name static-context">DateTime</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Publish At&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hideFromIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token class-name static-context">DateTime</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Publish Until&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hideFromIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n        <span class="token comment">// ...</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="更新页面隐藏字段" tabindex="-1"><a class="header-anchor" href="#更新页面隐藏字段" aria-hidden="true">#</a> 更新页面隐藏字段</h3><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">fields</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">[</span>\n        <span class="token comment">// ...</span>\n        <span class="token class-name static-context">Select</span><span class="token operator">::</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;category&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n            <span class="token string single-quoted-string">&#39;category-1&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Category One&#39;</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">hideWhenUpdating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div>',11),b=(0,e.Uk)("更多的隐藏和显示选项可以"),m={href:"https://nova.laravel.com/docs/2.0/resources/fields.html#showing-hiding-fields",target:"_blank",rel:"noopener noreferrer"},g=(0,e.Uk)("查看这里"),h=(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,"hideFromIndex"),(0,e.Wm)("li",null,"hideFromDetail"),(0,e.Wm)("li",null,"hideWhenCreating"),(0,e.Wm)("li",null,"hideWhenUpdating"),(0,e.Wm)("li",null,"onlyOnIndex"),(0,e.Wm)("li",null,"onlyOnDetail"),(0,e.Wm)("li",null,"onlyOnForms"),(0,e.Wm)("li",null,"exceptOnForms")],-1),v=(0,e.Wm)("h2",{id:"参考地址",tabindex:"-1"},[(0,e.Wm)("a",{class:"header-anchor",href:"#参考地址","aria-hidden":"true"},"#"),(0,e.Uk)(" 参考地址")],-1),f={href:"https://nova.laravel.com/docs/2.0/resources/fields.html#field-types",target:"_blank",rel:"noopener noreferrer"},y=(0,e.Uk)("Laravel Nova Field Types"),q={href:"https://nova.laravel.com/docs/2.0/resources/fields.html#showing-hiding-fields",target:"_blank",rel:"noopener noreferrer"},W=(0,e.Uk)("Laravel Nova Showing Or Hiding Fields"),w={render:function(n,s){const a=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.j4)(e.HY,null,[p,(0,e.Wm)("p",null,[t,(0,e.Wm)("a",l,[o,(0,e.Wm)(a)]),c]),i,(0,e.Wm)("blockquote",null,[(0,e.Wm)("p",null,[u,(0,e.Wm)("a",r,[k,(0,e.Wm)(a)])])]),d,(0,e.Wm)("blockquote",null,[(0,e.Wm)("p",null,[b,(0,e.Wm)("a",m,[g,(0,e.Wm)(a)])]),h]),v,(0,e.Wm)("ul",null,[(0,e.Wm)("li",null,[(0,e.Wm)("a",f,[y,(0,e.Wm)(a)])]),(0,e.Wm)("li",null,[(0,e.Wm)("a",q,[W,(0,e.Wm)(a)])])])],64)}}}}]);