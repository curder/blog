import{_ as d,r as l,o as c,c as r,b as n,a as e,w as p,F as u,d as s,e as i}from"./app.2572a747.js";const v={},m=n("h1",{id:"\u5982\u4F55\u5728ubuntu\u4E0A\u4F7F\u7528deployer\u81EA\u52A8\u90E8\u7F72laravel\u5E94\u7528\u7A0B\u5E8F",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5982\u4F55\u5728ubuntu\u4E0A\u4F7F\u7528deployer\u81EA\u52A8\u90E8\u7F72laravel\u5E94\u7528\u7A0B\u5E8F","aria-hidden":"true"},"#"),s(" \u5982\u4F55\u5728Ubuntu\u4E0A\u4F7F\u7528Deployer\u81EA\u52A8\u90E8\u7F72Laravel\u5E94\u7528\u7A0B\u5E8F")],-1),h={href:"https://laravel.com",target:"_blank",rel:"noopener noreferrer"},b=s("Laravel"),g=s("\u662F\u4E00\u4E2A\u5F00\u653E\u6E90\u4EE3\u7801\u7684PHP Web\u6846\u67B6\uFF0C\u65E8\u5728\u7B80\u5316\u8BA4\u8BC1\uFF0C\u8DEF\u7531\u548C\u7F13\u5B58\u7B49\u5E38\u89C1Web\u5F00\u53D1\u4EFB\u52A1\u3002"),k={href:"https://deployer.org",target:"_blank",rel:"noopener noreferrer"},_=s("Deployer"),y=s(" \u662F\u4E00\u6B3E\u5F00\u6E90\u7684PHP\u90E8\u7F72\u5DE5\u5177\uFF0C\u5B83\u4E3A\u8BB8\u591A\u6D41\u884C\u7684\u6846\u67B6\u63D0\u4F9B\u4E86\u5F00\u7BB1\u5373\u7528\u7684\u652F\u6301\uFF0C\u5305\u62EC"),f=n("code",null,"Laravel",-1),x=s("\uFF0C"),w=n("code",null,"CodeIgniter",-1),S=s("\uFF0C"),E=n("code",null,"Symfony",-1),q=s("\u548C"),P=n("code",null,"Zend Framework",-1),A=s("\u7B49\u7B49\u3002"),L=s("\u90E8\u7F72\u8005\u901A\u8FC7\u5C06\u5E94\u7528\u7A0B\u5E8F\u4ECEGit\u5B58\u50A8\u5E93\u514B\u9686\u5230\u670D\u52A1\u5668\uFF0C\u5B89\u88C5\u4E0E"),H={href:"https://getcomposer.org",target:"_blank",rel:"noopener noreferrer"},R=s("Composer"),D=s(" \u7684\u4F9D\u8D56\u5173\u7CFB\u4EE5\u53CA\u914D\u7F6E\u5E94\u7528\u7A0B\u5E8F\u6765\u81EA\u52A8\u6267\u884C\u90E8\u7F72\uFF0C\u56E0\u6B64\u60A8\u4E0D\u5FC5\u624B\u52A8\u6267\u884C\u6B64\u64CD\u4F5C\u3002\u8FD9\u4F7F\u5F00\u53D1\u8005\u53EF\u4EE5\u5C06\u66F4\u591A\u65F6\u95F4\u82B1\u5728\u5F00\u53D1\u4E0A\uFF0C\u800C\u4E0D\u662F\u4E0A\u4F20\u548C\u914D\u7F6E\uFF0C\u5E76\u5141\u8BB8\u5F00\u53D1\u8005\u66F4\u9891\u7E41\u5730\u8FDB\u884C\u90E8\u7F72\u3002"),G=n("h2",{id:"\u5F00\u59CB\u4E4B\u524D",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5F00\u59CB\u4E4B\u524D","aria-hidden":"true"},"#"),s(" \u5F00\u59CB\u4E4B\u524D")],-1),I=n("p",null,"\u5728\u5F00\u59CB\u4E4B\u524D\uFF0C\u60A8\u9700\u8981\u4EE5\u4E0B\u5185\u5BB9\uFF1A",-1),N=n("li",null,[s("\u4E00\u4E2A"),n("code",null,"Ubuntu 16.04"),s("\u670D\u52A1\u5668\uFF0C\u5177\u6709"),n("code",null,"sudo"),s("\u7279\u6743\u7684\u975Eroot\u7528\u6237\u3002")],-1),T=s("\u6309\u7167"),O=s("Ubuntu\u4E0B\u5FEB\u901F\u642D\u5EFALNMP\u73AF\u5883"),U=s("\u914D\u7F6E\u597D\u7684LNMP\u73AF\u5883"),M=s("\u4E00\u4E2AGit\u670D\u52A1\u5668\u3002\u53EF\u4EE5\u9009\u62E9\u4F7F\u7528"),C={href:"https://gogs.io",target:"_blank",rel:"noopener noreferrer"},B=s("Gogs"),F=s("\u3001"),Y={href:"https://about.gitlab.com",target:"_blank",rel:"noopener noreferrer"},V=s("GitLab"),z=s("\uFF0C"),j={href:"https://bitbucket.org",target:"_blank",rel:"noopener noreferrer"},Q=s("Bitbucket"),W=s(" \u6216"),X={href:"https://github.com",target:"_blank",rel:"noopener noreferrer"},$=s("GitHub"),K=s("\u7B49\u670D\u52A1\u3002"),J=n("code",null,"Gogs",-1),Z=s("\u3001"),nn=n("code",null,"GitLab",-1),sn=s("\u548C"),en=n("code",null,"Bitbucket",-1),an=s("\u514D\u8D39\u63D0\u4F9B\u79C1\u4EBA\u4ED3\u5E93\uFF0C\u800C"),ln=n("code",null,"GitHub",-1),tn=s("\u63D0\u4F9B\u79C1\u4EBA\u4ED3\u5E93\uFF0C\u6BCF\u6708**$7**\u8D77\u3002"),on=n("li",null,"\u6307\u5411\u751F\u4EA7\u670D\u52A1\u5668\u7684\u57DF\u540D\u3002",-1),dn=n("li",null,[n("code",null,"Composer"),s("\u548C"),n("code",null,"Git"),s("\u4E5F\u5B89\u88C5\u5728\u672C\u5730\u673A\u5668\u4E0A\u3002\u4F8B\u5982\u8FD9\u91CC\u7684MacOSX\u7CFB\u7EDF\u3002")],-1),cn=i(`<h2 id="\u8BBE\u7F6E\u672C\u5730\u5F00\u53D1\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u7F6E\u672C\u5730\u5F00\u53D1\u73AF\u5883" aria-hidden="true">#</a> \u8BBE\u7F6E\u672C\u5730\u5F00\u53D1\u73AF\u5883</h2><blockquote><p><strong>\u6B64\u90E8\u5206\u5728\u672C\u5730\u5F00\u53D1\u73AF\u5883\u64CD\u4F5C</strong>\uFF0C1. \u4E0B\u8F7D\u548C\u5B89\u88C5<code>deployer</code> 2. \u521D\u59CB\u5316\u4E00\u4E2A<code>laravel</code>\u9879\u76EE 3. \u4F7F\u672C\u5730\u5F00\u53D1\u73AF\u5883\u80FD\u591F\u514D\u5BC6\u63D0\u4EA4\u4EE3\u7801\u5230\u8FDC\u7A0Bgit\u4ED3\u5E93</p></blockquote><h3 id="\u4E0B\u8F7Ddeployer\u6269\u5C55" tabindex="-1"><a class="header-anchor" href="#\u4E0B\u8F7Ddeployer\u6269\u5C55" aria-hidden="true">#</a> \u4E0B\u8F7Ddeployer\u6269\u5C55</h3><p>\u7531\u4E8E\u5C06\u4ECE\u672C\u5730\u673A\u5668\u521B\u5EFA\u548C\u90E8\u7F72\u5E94\u7528\u7A0B\u5E8F\uFF0C\u56E0\u6B64\u9996\u5148\u914D\u7F6E\u672C\u5730\u5F00\u53D1\u73AF\u5883\u3002\u90E8\u7F72\u8005\u5C06\u4ECE\u672C\u5730\u673A\u5668\u63A7\u5236\u6574\u4E2A\u90E8\u7F72\u8FC7\u7A0B\uFF0C\u56E0\u6B64\u8BF7\u5148\u5B89\u88C5\u5B83\u3002</p><p>\u5728<strong>\u672C\u5730\u673A\u5668</strong>\u4E0A\uFF0C\u6253\u5F00\u7EC8\u7AEF\u5E76\u4F7F\u7528\u4E0B\u8F7D\u90E8\u7F72\u5668\u5B89\u88C5\u7A0B\u5E8F<code>composer</code>\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">composer</span> global require deployer/deployer -vvv
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5B89\u88C5\u5B8C\u6210\u4F60\u5E94\u8BE5\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u6765\u67E5\u770B\u5B83\u7684\u7248\u672C\u4FE1\u606F\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dep --version
<span class="token comment"># Deployer master</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFA\u4E00\u4E2Alaravel\u9879\u76EE" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u4E00\u4E2Alaravel\u9879\u76EE" aria-hidden="true">#</a> \u521B\u5EFA\u4E00\u4E2ALaravel\u9879\u76EE</h3><p>\u63A5\u4E0B\u6765\uFF0C\u5728<strong>\u672C\u5730\u673A\u5668</strong>\u4E0A\u521B\u5EFA\u4E00\u4E2ALaravel\u9879\u76EE\uFF08\u5047\u5982\u672C\u5730\u4EE3\u7801\u653E\u5728<code>~/Codes</code>\u76EE\u5F55\u4E0B\uFF09\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ~/Codes <span class="token operator">&amp;&amp;</span> <span class="token function">composer</span> create-project --prefer-dist laravel/laravel laravel-app <span class="token string">&quot;5.6.*&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u73B0\u5728\u5DF2\u7ECF\u5728\u672C\u5730\u8BA1\u7B97\u673A\u4E0A\u5B89\u88C5\u4E86\u6240\u6709\u5FC5\u9700\u7684\u6269\u5C55\u5305\u3002\u6709\u4E86\u8FD9\u4E2A\uFF0C\u6211\u4EEC\u5C06\u7EE7\u7EED\u4E3A\u5E94\u7528\u7A0B\u5E8F\u521B\u5EFA\u4E00\u4E2AGit\u4ED3\u5E93\u3002</p><h3 id="\u672C\u5730\u673A\u5668\u8FDE\u63A5\u5230\u60A8\u7684\u8FDC\u7A0Bgit\u4ED3\u5E93" tabindex="-1"><a class="header-anchor" href="#\u672C\u5730\u673A\u5668\u8FDE\u63A5\u5230\u60A8\u7684\u8FDC\u7A0Bgit\u4ED3\u5E93" aria-hidden="true">#</a> \u672C\u5730\u673A\u5668\u8FDE\u63A5\u5230\u60A8\u7684\u8FDC\u7A0BGit\u4ED3\u5E93</h3><p>\u90E8\u7F72\u65E8\u5728\u4F7F\u7528\u6237\u80FD\u591F\u4ECE\u4EFB\u4F55\u5730\u65B9\u90E8\u7F72\u4EE3\u7801\u3002\u4E3A\u4E86\u5B9E\u73B0\u8FD9\u4E00\u529F\u80FD\uFF0C\u5B83\u9700\u8981\u7528\u6237\u5C06\u4EE3\u7801\u63A8\u9001\u5230\u4E92\u8054\u7F51\u4E0A\u7684\u4ED3\u5E93\uFF0C\u7136\u540E\u90E8\u7F72\u4EBA\u5458\u5C06\u4EE3\u7801\u62F7\u8D1D\u5230\u751F\u4EA7\u670D\u52A1\u5668\u3002</p><p>\u6211\u4EEC\u5C06\u4F7F\u7528\u5F00\u6E90\u7248\u672C\u63A7\u5236\u7CFB\u7EDFGit\u6765\u7BA1\u7406Laravel\u5E94\u7528\u7A0B\u5E8F\u7684\u6E90\u4EE3\u7801\u3002\u53EF\u4EE5\u4F7F\u7528SSH\u534F\u8BAE\u8FDE\u63A5\u5230Git\u670D\u52A1\u5668\uFF0C\u4E3A\u4E86\u5B89\u5168\u5730\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u60A8\u9700\u8981\u751F\u6210SSH\u5BC6\u94A5\u3002\u8FD9\u6BD4\u57FA\u4E8E\u5BC6\u7801\u7684\u8EAB\u4EFD\u9A8C\u8BC1\u66F4\u5B89\u5168\uFF0C\u540C\u65F6\u4E5F\u53EF\u4EE5\u907F\u514D\u5728\u6BCF\u6B21\u90E8\u7F72\u524D\u8F93\u5165\u5BC6\u7801\u3002</p><h4 id="\u7F16\u8F91ssh\u5BC6\u94A5" tabindex="-1"><a class="header-anchor" href="#\u7F16\u8F91ssh\u5BC6\u94A5" aria-hidden="true">#</a> \u7F16\u8F91SSH\u5BC6\u94A5</h4><p>\u5728\u672C\u5730\u8BA1\u7B97\u673A\u4E0A\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\u4EE5\u751F\u6210SSH\u5BC6\u94A5\u3002\u8BF7\u6CE8\u610F\uFF0C<code>-f</code>\u53C2\u6570\u6307\u5B9A\u5BC6\u94A5\u6587\u4EF6\u7684\u6587\u4EF6\u540D\uFF0C\u5E76\u4E14\u53EF\u4EE5\u81EA\u5B9A\u4E49\u6587\u4EF6\u540D\u66FF\u6362<code>gitkey</code>\u3002\u5B83\u4F1A\u751F\u6210\u4E00\u4E2ASSH\u5BC6\u94A5\u5BF9\uFF08\u547D\u540D<code>gitkey</code>\u548C<code>gitkey.pub</code>\uFF09\u5230\u8BE5<code>~/.ssh/</code>\u6587\u4EF6\u5939\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ssh-keygen -t rsa -b <span class="token number">4096</span> -f  ~/.ssh/gitkey
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u5F00\u53D1\u8005\u53EF\u80FD\u5728\u672C\u5730\u8BA1\u7B97\u673A\u4E0A\u62E5\u6709\u5F88\u591A\u7684SSH\u5BC6\u94A5\uFF0C\u56E0\u6B64\u5728\u914D\u7F6ESSH\u5BA2\u6237\u7AEF\u4E4B\u524D\u4E86\u89E3\u5728\u8FDE\u63A5\u5230Git\u670D\u52A1\u5668\u65F6\u4F7F\u7528\u54EA\u4E2ASSH\u4E13\u7528\u5BC6\u94A5\u3002\u5F53\u7136\u4E5F\u53EF\u4EE5\u4F7F\u7528\u4E4B\u524D\u5DF2\u7ECF\u5B58\u5728\u7684SSH\u5BC6\u94A5\u3002</p></blockquote><h4 id="\u521B\u5EFA\u4E00\u4E2Assh\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u4E00\u4E2Assh\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u521B\u5EFA\u4E00\u4E2ASSH\u914D\u7F6E\u6587\u4EF6</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> ~/.ssh/config
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6253\u5F00\u6587\u4EF6\u5E76\u4E3AGit\u670D\u52A1\u5668\u6DFB\u52A0\u4E00\u4E2A\u5FEB\u6377\u65B9\u5F0F\u3002\u8FD9\u5E94\u8BE5\u5305\u542B<code>HostName</code>\u6307\u4EE4\uFF08\u6307\u5411Git\u670D\u52A1\u5668\u7684\u4E3B\u673A\u540D\uFF09\u548C<code>IdentityFile</code>\u6307\u4EE4\uFF08\u6307\u5411\u60A8\u521A\u521A\u521B\u5EFA\u7684SSH\u5BC6\u94A5\u7684\u6587\u4EF6\u8DEF\u5F84\uFF09\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Host mygitserver.com
    HostName mygitserver.com
    IdentityFile ~/.ssh/gitkey
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u6837\u914D\u7F6E\u7684\u8BDD\uFF0CSSH\u5BA2\u6237\u7AEF\u5C06\u77E5\u9053\u4F7F\u7528\u54EA\u4E2A\u79C1\u94A5\u8FDE\u63A5\u5230Git\u670D\u52A1\u5668\u3002</p><p>\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u663E\u793A\u516C\u94A5\u6587\u4EF6\u7684\u5185\u5BB9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> ~/.ssh/gitkey.pub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u590D\u5236\u8F93\u51FA\u5E76\u5C06\u516C\u94A5\u6DFB\u52A0\u5230\u60A8\u7684Git\u670D\u52A1\u5668\u3002</p><p>\u5982\u679C\u4F7F\u7528Git\u6258\u7BA1\u670D\u52A1\uFF0C\u8BF7\u53C2\u9605\u6709\u5173\u5982\u4F55\u5C06SSH\u5BC6\u94A5\u6DFB\u52A0\u5230\u60A8\u7684\u5E10\u6237\u7684\u6587\u6863\uFF1A</p>`,28),rn={href:"https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account",target:"_blank",rel:"noopener noreferrer"},pn=s("\u5C06SSH\u5BC6\u94A5\u6DFB\u52A0\u5230GitHub"),un={href:"https://docs.gitlab.com/ee/gitlab-basics/create-your-ssh-keys.html",target:"_blank",rel:"noopener noreferrer"},vn=s("\u5C06SSH\u5BC6\u94A5\u6DFB\u52A0\u5230GitLab"),mn={href:"https://confluence.atlassian.com/bitbucket/set-up-an-ssh-key-728138079.html",target:"_blank",rel:"noopener noreferrer"},hn=s("\u5C06SSH\u5BC6\u94A5\u6DFB\u52A0\u5230Bitbucket"),bn=i(`<p>\u6DFB\u52A0\u5B8C\u6210\u4E4B\u540E\uFF0C\u73B0\u5728\u53EF\u4EE5\u4F7F\u7528\u672C\u5730\u673A\u5668\u8FDE\u63A5\u5230Git\u670D\u52A1\u5668\u3002\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u6D4B\u8BD5\u8FDE\u63A5</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ssh</span> -T git@mygitserver.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u6B64\u547D\u4EE4\u5BFC\u81F4\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u662F\u5426\u901A\u8FC7\u5F15\u7528Git\u6258\u7BA1\u670D\u52A1\u7684\u6587\u6863\u6B63\u786E\u6DFB\u52A0\u4E86SSH\u5BC6\u94A5\uFF0C\u7136\u540E\u518D\u6B21\u5C1D\u8BD5\u8FDE\u63A5\u3002</p><p>\u5728\u5C06\u5E94\u7528\u7A0B\u5E8F\u63A8\u9001\u5230\u8FDC\u7A0BGit\u5B58\u50A8\u5E93\u5E76\u8FDB\u884C\u90E8\u7F72\u4E4B\u524D\uFF0C\u6211\u4EEC\u5148\u914D\u7F6E\u751F\u4EA7\u670D\u52A1\u5668\u3002</p><h2 id="\u914D\u7F6E\u751F\u4EA7\u670D\u52A1\u5668" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u751F\u4EA7\u670D\u52A1\u5668" aria-hidden="true">#</a> \u914D\u7F6E\u751F\u4EA7\u670D\u52A1\u5668</h2><blockquote><p>\u6B64\u90E8\u5206\u5728\u76EE\u6807\u670D\u52A1\u5668\u5373<strong>\u751F\u4EA7\u670D\u52A1\u5668</strong>\u4E0A\u64CD\u4F5C 1. \u521B\u5EFA\u4E00\u4E2A\u90E8\u7F72\u7528\u6237\u7528\u4E8E\u90E8\u7F72 2. \u6388\u6743\u90E8\u7F72\u7528\u6237\u7684\u76F8\u5173\u64CD\u4F5C 3. \u4F7F\u751F\u4EA7\u73AF\u5883\u80FD\u591F\u514D\u5BC6\u62C9\u53D6\u8FDC\u7A0Bgit\u4ED3\u5E93\u4EE3\u7801</p></blockquote><h3 id="\u914D\u7F6E\u90E8\u7F72\u8005\u7528\u6237" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u90E8\u7F72\u8005\u7528\u6237" aria-hidden="true">#</a> \u914D\u7F6E\u90E8\u7F72\u8005\u7528\u6237</h3><p>\u90E8\u7F72\u8005\u4F7F\u7528SSH\u534F\u8BAE\u5728\u670D\u52A1\u5668\u4E0A\u5B89\u5168\u5730\u6267\u884C\u547D\u4EE4\u3002\u51FA\u4E8E\u8FD9\u4E2A\u539F\u56E0\uFF0C\u6211\u4EEC\u5C06\u5411\u914D\u7F6E\u751F\u4EA7\u670D\u52A1\u5668\u521B\u5EFA\u4E00\u4E2A\u7528\u6237\uFF0CDeployer\u53EF\u4EE5\u4F7F\u7528\u8BE5\u7528\u6237\u901A\u8FC7SSH\u767B\u5F55\u5E76\u5728\u60A8\u7684\u670D\u52A1\u5668\u4E0A\u6267\u884C\u547D\u4EE4\u3002 \u4F7F\u7528sudo\u975Eroot\u7528\u6237\u767B\u5F55\u5230\u751F\u4EA7\u670D\u52A1\u5668\uFF0C\u5E76\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u521B\u5EFA\u4E00\u4E2A\u540D\u4E3A<code>deployer</code>\u7684\u65B0\u7528\u6237\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">unzip</span> <span class="token function">git</span>
<span class="token function">sudo</span> adduser deployer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u521B\u5EFA\u4E00\u4E2A<code>deployer</code>\u90E8\u7F72\u7528\u6237\uFF0C\u4E0A\u9762\u7684\u547D\u4EE4\u6309\u56DE\u8F66\u540E\u8F93\u5165\u7528\u6237\u5BC6\u7801\u548C\u91CD\u590D\u5BC6\u7801\u540E\u76F4\u63A5\u6309\u56DE\u8F66\u5373\u53EF\u3002</p></blockquote><p>Laravel\u9700\u8981\u4E00\u4E9B\u53EF\u5199\u7684\u76EE\u5F55\u6765\u5B58\u50A8\u7F13\u5B58\u7684\u6587\u4EF6\u548C\u4E0A\u4F20\u6587\u4EF6\uFF0C\u56E0\u6B64\u90E8\u7F72\u8005\u7528\u6237\u521B\u5EFA\u7684\u76EE\u5F55\u5FC5\u987B\u53EF\u7531Nginx Web\u670D\u52A1\u5668\u5199\u5165\u3002\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4\u5C06\u7528\u6237\u6DFB\u52A0\u5230<code>www-data</code>\u7EC4\u4E2D\u4EE5\u6267\u884C\u6B64\u64CD\u4F5C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">usermod</span> -aG www-data deployer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u90E8\u7F72\u8005</strong>\u7528\u6237\u521B\u5EFA\u7684\u6587\u4EF6\u7684\u9ED8\u8BA4\u6743\u9650\u5E94\u8BE5644\u7528\u4E8E\u6587\u4EF6\u548C755\u76EE\u5F55\u3002\u8FD9\u6837<strong>\u90E8\u7F72\u8005</strong>\u7528\u6237\u5C06\u80FD\u591F\u8BFB\u53D6\u548C\u5199\u5165\u6587\u4EF6\uFF0C\u800C\u7EC4\u548C\u5176\u4ED6\u7528\u6237\u5C06\u80FD\u591F\u8BFB\u53D6\u5B83\u4EEC\u3002</p><p>\u901A\u8FC7\u5C06<strong>\u90E8\u7F72\u8005</strong>\u7684\u9ED8\u8BA4<code>umask</code>\u8BBE\u7F6E\u4E3A<code>022</code>\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> chfn -o <span class="token assign-left variable">umask</span><span class="token operator">=</span>022 deployer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6211\u4EEC\u5C06\u5E94\u7528\u7A0B\u5E8F\u5B58\u50A8\u5728<code>/var/www/html/</code>\u76EE\u5F55\u4E2D\uFF0C\u56E0\u6B64\u5C06\u76EE\u5F55\u7684\u6240\u6709\u6743\u66F4\u6539\u4E3A\u90E8\u7F72\u8005\u7528\u6237\u548C<code>www-data</code>\u7EC4\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /var/www/html <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">chown</span> deployer:www-data /var/www/html <span class="token comment"># \u6700\u540E\u8FD9\u91CC\u4E0D\u8981\u52A0\u659C\u7EBF\u54E6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BE5<strong>\u90E8\u7F72</strong>\u7684\u7528\u6237\u9700\u8981\u80FD\u591F\u5728\u4E2D\u4FEE\u6539\u6587\u4EF6\u548C\u6587\u4EF6\u5939<code>/var/www/html</code>\u76EE\u5F55\u3002\u56E0\u6B64\u76EE\u5F55\u4E2D\u521B\u5EFA\u7684\u6240\u6709\u65B0\u6587\u4EF6\u548C\u5B50\u76EE\u5F55<code>/var/www/html</code> \u90FD\u5E94\u8BE5\u7EE7\u627F\u8BE5\u6587\u4EF6\u5939\u7684\u7EC4\u6807\u8BC6\uFF08www-data\uFF09\u3002\u8981\u5B9E\u73B0\u8FD9\u4E2A\u76EE\u6807\uFF0C\u8BF7\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u5728\u6B64\u76EE\u5F55\u4E2D\u8BBE\u7F6E\u7EC4ID\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">chmod</span> g+s /var/www/html
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u90E8\u7F72\u8005</strong>\u5C06\u4F7F\u7528SSH\u5C06Git repo\u514B\u9686\u5230\u751F\u4EA7\u670D\u52A1\u5668\uFF0C\u56E0\u6B64\u60A8\u8981\u786E\u4FDD\u751F\u4EA7\u670D\u52A1\u5668\u548CGit\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u8FDE\u63A5\u662F\u5B89\u5168\u7684\u3002\u8FD9\u91CC\u5C06\u4F7F\u7528\u4E0E\u7528\u4E8E\u672C\u5730\u8BA1\u7B97\u673A\u7684\u76F8\u540C\u65B9\u6CD5\uFF0C\u5E76\u4E3A\u90E8\u7F72\u8005\u7528\u6237\u751F\u6210\u4E00\u4E2ASSH\u5BC6\u94A5\u3002</p><h3 id="\u9879\u76EEgit\u4ED3\u5E93\u6388\u6743\u751F\u4EA7\u670D\u52A1\u5668\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#\u9879\u76EEgit\u4ED3\u5E93\u6388\u6743\u751F\u4EA7\u670D\u52A1\u5668\u8BBF\u95EE" aria-hidden="true">#</a> \u9879\u76EEgit\u4ED3\u5E93\u6388\u6743\u751F\u4EA7\u670D\u52A1\u5668\u8BBF\u95EE</h3><p>\u5207\u6362\u5230\u670D\u52A1\u5668\u4E0A\u7684<strong>\u90E8\u7F72\u8005</strong>\u7528\u6237\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">su</span> - deployer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u751F\u6210\u4E00\u4E2ASSH\u5BC6\u94A5\u5BF9\u4F5C\u4E3A<strong>\u90E8\u7F72\u8005</strong>\u7528\u6237\u3002\u8FD9\u4E00\u6B21\uFF0C\u53EF\u4EE5\u63A5\u53D7SSH\u5BC6\u94A5\u7684\u9ED8\u8BA4\u6587\u4EF6\u540D\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ssh-keygen -t rsa -b <span class="token number">4096</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u8F93\u5165\u5B8C\u547D\u4EE4\u540E\u4E00\u76F4\u6309Enter\u5373\u53EF\u3002</p></blockquote><p>\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4\u663E\u793A\u516C\u94A5\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> ~/.ssh/id_rsa.pub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u50CF\u4E0A\u4E00\u6B65\u90A3\u6837\u590D\u5236\u672C\u5730\u516C\u94A5\u6587\u4EF6\u4E00\u6837\u5E76\u5C06\u5176\u6DFB\u52A0\u5230Git\u670D\u52A1\u5668\uFF0C\u73B0\u5728\u670D\u52A1\u5668\u5C31\u53EF\u4EE5\u4ECEgit\u4ED3\u5E93clone\u4EE3\u7801\u4E86\u3002</p><p>\u6B64\u65F6\uFF0C\u53EF\u4EE5\u5728\u670D\u52A1\u5668\u4F7F\u7528<code>deployer</code>\u7528\u6237\u4F7F\u7528 <code>git clone</code>\u547D\u4EE4\u62F7\u8D1Dgit\u4ED3\u5E93\u6D4B\u8BD5\u3002\u5982\u679C\u4E0D\u80FD\u6210\u529F\u62F7\u8D1D\u4ED3\u5E93\u4EE3\u7801\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668\u7684\u516C\u94A5\u662F\u5426\u6B63\u786E\u5B8C\u5168\u7684\u590D\u5236\u4E0E\u7C98\u8D34\u6B63\u786E\uFF0C\u4E0D\u6B63\u786E\u7684\u8BDD\u518D\u6B21\u91CD\u590D\u590D\u5236\u7C98\u8D34\u5373\u53EF\u3002</p><h2 id="\u5F00\u53D1\u73AF\u5883\u514D\u5BC6\u7801\u767B\u5F55\u751F\u4EA7\u73AF\u5883" tabindex="-1"><a class="header-anchor" href="#\u5F00\u53D1\u73AF\u5883\u514D\u5BC6\u7801\u767B\u5F55\u751F\u4EA7\u73AF\u5883" aria-hidden="true">#</a> \u5F00\u53D1\u73AF\u5883\u514D\u5BC6\u7801\u767B\u5F55\u751F\u4EA7\u73AF\u5883</h2><h3 id="\u5F00\u53D1\u73AF\u5883\u751F\u6210\u5BC6\u5319" tabindex="-1"><a class="header-anchor" href="#\u5F00\u53D1\u73AF\u5883\u751F\u6210\u5BC6\u5319" aria-hidden="true">#</a> \u5F00\u53D1\u73AF\u5883\u751F\u6210\u5BC6\u5319</h3><blockquote><p><strong>\u6B64\u90E8\u5206\u5728\u672C\u5730\u5F00\u53D1\u73AF\u5883\u64CD\u4F5C</strong> 1. \u4F7F\u672C\u5730\u5F00\u53D1\u73AF\u5883\u80FD\u591F\u514D\u5BC6\u767B\u5F55\u751F\u4EA7\u73AF\u5883</p></blockquote><p>\u5728<strong>\u672C\u5730\u5F00\u53D1\u673A\u5668</strong>\u4E0A\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\u3002\u968F\u610F\u7528\u60A8\u9009\u62E9\u7684\u6587\u4EF6\u540D\u66FF\u6362<code>deployerkey</code>\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ssh-keygen -t rsa -b <span class="token number">4096</span> -f  ~/.ssh/deployerkey
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u590D\u5236\u5305\u542B\u516C\u94A5\u7684\u4EE5\u4E0B\u547D\u4EE4\u7684\u8F93\u51FA\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> ~/.ssh/deployerkey.pub
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u4FEE\u6539\u5F00\u53D1\u73AF\u5883\u6587\u4EF6\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539\u5F00\u53D1\u73AF\u5883\u6587\u4EF6\u5185\u5BB9" aria-hidden="true">#</a> \u4FEE\u6539\u5F00\u53D1\u73AF\u5883\u6587\u4EF6\u5185\u5BB9</h3><blockquote><p><strong>\u6B64\u90E8\u5206\u5728\u751F\u4EA7\u73AF\u5883\u64CD\u4F5C</strong> \u751F\u4EA7\u73AF\u5883\u4FEE\u6539<code>~/.ssh/authorized_keys</code>\u5185\u5BB9\u548C\u6743\u9650</p></blockquote><p>\u5C06\u4E0A\u9762\u590D\u5236\u7684\u516C\u94A5\u5185\u5BB9\uFF0C\u6DFB\u52A0\u5230\u751F\u4EA7\u670D\u52A1\u5668\u4E0A\u7684<code>~/.ssh/authorized_keys</code>\u6587\u4EF6\u5185\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u4F7F\u7528vi\u7F16\u8F91\u5668\u6253\u5F00\u6587\u4EF6</span>
<span class="token function">vi</span> ~/.ssh/authorized_keys

<span class="token comment"># \u7C98\u8D34\u4E0B\u9762\u7684\u5185\u5BB9\u5230\u6587\u4EF6\u4E2D</span>
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDLjvl3r+Mlk975SW8zJrNrkIqwKe573LcYscq0F0DRPePVOxGcoqNMx/DGLewOf70Ozc3OuHTwkQIuj1mxOJ6w/W8qTgXr4X5szE1DfvHr/0Nnn/rJBTWm6qas0ktNGgYkixS4AJMcnXwuGDU8NSu+lSrkhYmi/+yN/fpyHUGhSLbT7LP1XxaTEDQNjjyGbgJgTEkrL1ZwlXW7CtwFLBKxm60JkQzUk39FPu6tXZGIQDcixL3CNIiHxdSIOroxvYdEVKfv6YyKKR1uizSbE3GjDrn7CDEE1LHmrHXOhbU805rdbyykIaYORMhSRZ869bRRAMhZDqzcdpu4kwVLeIOr xiaoluo@bogon
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u6CE8\u610F\u5728\u751F\u4EA7\u670D\u52A1\u5668\u4E0A\uFF0C\u4F7F\u7528<strong>\u90E8\u7F72\u8005</strong><code>deployer</code>\u7528\u6237\u4FEE\u6539\u4E0A\u9762\u7684\u6587\u4EF6\u5185\u5BB9\u3002</p></blockquote><p>\u4FEE\u6539\u5B8C\u6210\u540E\uFF0C\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4\u4FEE\u6539\u6587\u4EF6\u6743\u9650\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/authorized_keys
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u4F7F\u7528\u90E8\u7F72\u7528\u6237\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u90E8\u7F72\u7528\u6237\u6D4B\u8BD5" aria-hidden="true">#</a> \u4F7F\u7528\u90E8\u7F72\u7528\u6237\u6D4B\u8BD5</h3><p>\u4F5C\u4E3A<strong>\u90E8\u7F72\u8005</strong>\u7528\u6237\uFF0C\u4ECE\u672C\u5730\u8BA1\u7B97\u673A\u767B\u5F55\u5230\u670D\u52A1\u5668\u4EE5\u6D4B\u8BD5\u8FDE\u63A5\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ssh</span> deployer@your_server_ip  -i ~/.ssh/deployerkey
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u518D\u4EE5\u90E8\u7F72\u8005\u8EAB\u4EFD\u767B\u5F55\u540E\uFF0C\u6D4B\u8BD5\u670D\u52A1\u5668\u548CGit\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u8FDE\u63A5\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ssh</span> -T git@mygitserver.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u662FGogs\u4EE3\u7801\u4ED3\u5E93\u670D\u52A1\u5668\uFF0C\u5927\u81F4\u8F93\u51FA\u4F1A\u662F\u8FD9\u6837\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Hi there, You&#39;ve successfully authenticated, but Gogs does not provide shell access.
If this is unexpected, please log in with password and setup Gogs under another user.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u914D\u7F6Enginx" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6Enginx" aria-hidden="true">#</a> \u914D\u7F6ENginx</h2><blockquote><p>\u4EE5\u4E0B\u914D\u7F6E\u5728<strong>\u751F\u4EA7\u670D\u52A1\u5668</strong>\u914D\u7F6E\u3002</p></blockquote><h3 id="\u521B\u5EFA\u4E00\u4E2A\u7AD9\u70B9\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA\u4E00\u4E2A\u7AD9\u70B9\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u521B\u5EFA\u4E00\u4E2A\u7AD9\u70B9\u914D\u7F6E\u6587\u4EF6</h3><p>\u4EE5<code>sudo</code>\u7528\u6237\u8EAB\u4EFD\u767B\u5F55\u5230\u670D\u52A1\u5668\u5E76\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u914D\u7F6E\u6587\u4EF6\u3002\u5C06\u914D\u7F6E\u4E2D\u7684\u57DF\u540D<code>example.com</code>\u66FF\u6362\u4E3A\u4F60\u5F53\u524D\u64CD\u4F5C\u7684\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/nginx/sites-available/example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5927\u81F4\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">listen</span> [::]:80</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">root</span> /var/www/html/laravel-app/current/public</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">index</span> index.php index.html index.htm index.nginx-debian.html</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">server_name</span> example.com www.example.com</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.php?<span class="token variable">$query_string</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> ~ \\.php$</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">include</span> snippets/fastcgi-php.conf</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">fastcgi_param</span> SCRIPT_FILENAME <span class="token variable">$realpath_root</span><span class="token variable">$fastcgi_script_name</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">fastcgi_param</span> DOCUMENT_ROOT <span class="token variable">$realpath_root</span></span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">fastcgi_pass</span> unix:/run/php/php7.1-fpm.sock</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> ~ /\\.ht</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">deny</span> all</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u4F7Fnginx\u914D\u7F6E\u751F\u6548" tabindex="-1"><a class="header-anchor" href="#\u4F7Fnginx\u914D\u7F6E\u751F\u6548" aria-hidden="true">#</a> \u4F7Fnginx\u914D\u7F6E\u751F\u6548</h3><p>\u901A\u8FC7\u521B\u5EFA\u7B26\u53F7\u94FE\u63A5\u542F\u7528\u65B0\u7684\u670D\u52A1\u5668\u6A21\u5757sites-enabled\u76EE\u5F55\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">ln</span> -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u6D4B\u8BD5\u914D\u7F6E\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u914D\u7F6E\u8BED\u6CD5" aria-hidden="true">#</a> \u6D4B\u8BD5\u914D\u7F6E\u8BED\u6CD5</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> nginx -t
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u60A8\u770B\u5230\u4EFB\u4F55\u9519\u8BEF\uFF0C\u8BF7\u8FD4\u56DE\u5E76\u91CD\u65B0\u68C0\u67E5\u914D\u7F6E\u6587\u4EF6\uFF0C\u7136\u540E\u518D\u7EE7\u7EED\u3002</p><h3 id="\u91CD\u65B0\u542F\u52A8nginx" tabindex="-1"><a class="header-anchor" href="#\u91CD\u65B0\u542F\u52A8nginx" aria-hidden="true">#</a> \u91CD\u65B0\u542F\u52A8Nginx</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> nginx restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u73B0\u5728\u914D\u7F6ENginx\u670D\u52A1\u5668\u3002\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u5C06\u914D\u7F6E\u5E94\u7528\u7A0B\u5E8F\u7684MySQL\u6570\u636E\u5E93\u3002</p><h2 id="\u914D\u7F6Emysql" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6Emysql" aria-hidden="true">#</a> \u914D\u7F6EMySQL</h2><blockquote><p>\u4EE5\u4E0B\u914D\u7F6E\u5728<strong>\u751F\u4EA7\u670D\u52A1\u5668</strong>\u914D\u7F6E\u3002</p></blockquote><p>\u4EE5root\u8EAB\u4EFD\u767B\u5F55\u5230MySQL\u63A7\u5236\u53F0\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysql -u root -p
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD9\u4F1A\u63D0\u793A\u4F60\u8F93\u5165root\u5BC6\u7801\uFF0C\u6B63\u786E\u8F93\u5165root\u5BC6\u7801\u540E\u3002\u63A5\u4E0B\u6765\uFF0C\u4E3A\u5E94\u7528\u7A0B\u5E8F\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6570\u636E\u5E93\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span>
<span class="token keyword">DATABASE</span> laravel_app <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_unicode_ci<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\uFF0C\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u6570\u636E\u5E93\u7528\u6237\u3002\u8FD9\u91CC\u6F14\u793A\u4F7F\u7528\u7528\u6237\u540D\uFF1A<code>laravel_user</code>\u548C\u5BC6\u7801\uFF1A<code>password</code>\uFF0C\u4F46\u5B9E\u9645\u60C5\u51B5\u5E94\u8BE5\u4F7F\u7528\u5F3A\u5BC6\u7801\u3002</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span>
<span class="token keyword">USER</span> <span class="token string">&#39;laravel_user&#39;</span><span class="token variable">@&#39;localhost&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;password&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6388\u4E88\u7528\u6237\u6570\u636E\u5E93\u6743\u9650\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">GRANT</span>
<span class="token keyword">ALL</span>
<span class="token keyword">ON</span> laravel_app<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">&#39;laravel_user&#39;</span><span class="token variable">@&#39;localhost&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u91CD\u65B0\u52A0\u8F7D\u6743\u9650\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>FLUSH
<span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u540E\uFF0C<code>exit</code>\u9000\u51FAMySQL\u63A7\u5236\u53F0\u3002</p><h2 id="\u90E8\u7F72\u5E94\u7528\u7A0B\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u90E8\u7F72\u5E94\u7528\u7A0B\u5E8F" aria-hidden="true">#</a> \u90E8\u7F72\u5E94\u7528\u7A0B\u5E8F</h2><h3 id="\u914D\u7F6Edeployer" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6Edeployer" aria-hidden="true">#</a> \u914D\u7F6Edeployer</h3><p>\u5230\u76EE\u524D\u4E3A\u6B62\uFF0C\u5DF2\u7ECF\u914D\u7F6E\u4E86<strong>\u90E8\u7F72\u8005</strong>\u8FD0\u884C\u6240\u9700\u7684\u6240\u6709\u5DE5\u5177\u548C\u7A0B\u5E8F\u3002\u5728\u8FD0\u884C\u7B2C\u4E00\u4E2A\u90E8\u7F72\u4E4B\u524D\uFF0C\u5269\u4E0B\u7684\u5DE5\u4F5C\u5C31\u662F\u5B8C\u6210Laravel\u5E94\u7528\u7A0B\u5E8F\u548CDeployer\u672C\u8EAB\u7684\u914D\u7F6E\uFF0C\u5E76\u521D\u59CB\u5316\u5E76\u5C06\u9879\u76EE\u4EE3\u7801\u63A8\u9001\u5230\u8FDC\u7A0BGit\u5B58\u50A8\u5E93\u3002</p><p>\u6253\u5F00<strong>\u672C\u5730\u5F00\u53D1\u673A\u5668</strong>\u4E0A\u7684\u7EC8\u7AEF\uFF0C\u5E76\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u5C06\u5DE5\u4F5C\u76EE\u5F55\u66F4\u6539\u4E3A\u5E94\u7528\u7A0B\u5E8F\u7684\u6587\u4EF6\u5939\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ~/Codes/laravel-app
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u8BE5\u76EE\u5F55\u4E2D\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\uFF0C\u8BE5\u547D\u4EE4\u5C06\u521B\u5EFA\u5728\u9879\u76EE\u6839\u76EE\u5F55<code>laravel-app</code>\u4E0B\u521B\u5EFA\u4E00\u4E2A<code>deploy.php</code>\u6587\u4EF6\uFF0C\u8BE5\u6587\u4EF6\u5C06\u5305\u542B\u914D\u7F6E\u4FE1\u606F\u548C\u90E8\u7F72\u4EFB\u52A1\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dep init -t Laravel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u5728\u6587\u672C\u7F16\u8F91\u5668\u6216IDE\u6253\u5F00<code>deploy.php</code>\u6587\u4EF6\u3002\u7B2C\u4E09\u884C\u5305\u542B\u4E00\u4E2APHP\u811A\u672C\uFF0C\u5176\u4E2D\u5305\u542B\u90E8\u7F72Laravel\u5E94\u7528\u7A0B\u5E8F\u6240\u9700\u7684\u4EFB\u52A1\u548C\u914D\u7F6E\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">Deployer</span><span class="token punctuation">;</span>

<span class="token keyword">require</span> <span class="token string single-quoted-string">&#39;recipe/laravel.php&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// Project name</span>
<span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;application&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;laravel-app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Timeout</span>
<span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;default_timeout&#39;</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Project repository</span>
<span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;repository&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;git@gogs.curder.com:curder/laravel-app.git&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// [Optional] Allocate tty for git clone. Default value is false.</span>
<span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;git_tty&#39;</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Shared files/dirs between deploys</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;shared_files&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;shared_dirs&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Writable dirs by web server</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;writable_dirs&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Hosts</span>
<span class="token function">host</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;server_ip&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u586B\u5199\u751F\u4EA7\u670D\u52A1\u5668IP\u5730\u5740</span>
    <span class="token operator">-&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;deployer&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u586B\u5199\u751F\u4EA7\u670D\u52A1\u5668\u90E8\u7F72\u7528\u6237\u540D</span>
    <span class="token operator">-&gt;</span><span class="token function">identityFile</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;~/.ssh/deployerkey&#39;</span><span class="token punctuation">)</span> <span class="token comment">// \u79D8\u94A5\u6587\u4EF6</span>
    <span class="token operator">-&gt;</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;deploy_path&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;/var/www/html/laravel-app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Tasks</span>
<span class="token function">task</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;build&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;cd {{release_path}} &amp;&amp; build&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u81EA\u5B9A\u4E49\u4EFB\u52A1\uFF1A\u91CD\u7F6E PHP-FPM \u8FDB\u7A0B</span>
<span class="token comment">// desc(&#39;Restart PHP-FPM service&#39;);</span>
<span class="token comment">// task(&#39;php-fpm:reload&#39;, function () {</span>
<span class="token comment">//    // The user must have rights for reload service</span>
<span class="token comment">//    // /etc/sudoers: deployer ALL=NOPASSWD:/binsystemctls service n relo restartad php7.1-fpm.service</span>
<span class="token comment">//    run(&#39;sudo systemctl reload php7.1-fpm.service&#39;);</span>
<span class="token comment">//});</span>

<span class="token comment">// [Optional] if deploy fails automatically unlock.</span>
<span class="token function">after</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;deploy:failed&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;deploy:unlock&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Migrate database before symlink new release.</span>
<span class="token comment">// before(&#39;deploy:symlink&#39;, &#39;artisan:migrate&#39;);</span>
<span class="token comment">// \u90E8\u7F72\u6210\u529F\u540E\u91CD\u7F6E PHP-FPM \u7F13\u5B58</span>
<span class="token comment">// after(&#39;deploy:symlink&#39;, &#39;php-fpm:reload&#39;);</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u4FEE\u6539\u4E0A\u9762\u7684 <code>servier_ip</code></p></blockquote>`,90),gn=s("\u76F8\u5173\u7684\u6307\u4EE4\u8BE6\u89C1"),kn={href:"https://deployer.org/docs",target:"_blank",rel:"noopener noreferrer"},_n=s("\u5B98\u65B9\u6587\u6863"),yn=i(`<p>\u63A5\u4E0B\u6765\uFF0C\u6CE8\u91CA\u6389\u6587\u4EF6\u76F8\u5173\u884C<code>before(&#39;deploy:symlink&#39;, &#39;artisan:migrate&#39;);</code> \u3002\u6B64\u884C\u6307\u793A\u90E8\u7F72\u8005\u81EA\u52A8\u8FD0\u884C\u6570\u636E\u5E93\u8FC1\u79FB\uFF0C\u5E76\u901A\u8FC7\u6CE8\u91CA\u5C06\u5176\u7981\u7528\u3002\u5982\u679C\u4E0D\u6CE8\u91CA\u5B83\uFF0C\u90E8\u7F72\u5C06\u5931\u8D25\uFF0C\u56E0\u4E3A\u6B64\u884C\u9700\u8981\u5728\u670D\u52A1\u5668\u4E0A\u63D0\u4F9B\u9879\u76EE\u7684\u6570\u636E\u5E93\u914D\u7F6E\uFF0C\u53EA\u80FD\u4F7F\u7528\u5728\u9996\u6B21\u90E8\u7F72\u671F\u95F4\u751F\u6210\u7684\u6587\u4EF6\u4E4B\u540E\u6765\u6DFB\u52A0\u8BE5\u884C\u3002</p><h3 id="\u63D0\u4EA4\u9879\u76EE\u4EE3\u7801\u5230git" tabindex="-1"><a class="header-anchor" href="#\u63D0\u4EA4\u9879\u76EE\u4EE3\u7801\u5230git" aria-hidden="true">#</a> \u63D0\u4EA4\u9879\u76EE\u4EE3\u7801\u5230git</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> ~/Code/laravel-app
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728<code>laravel-app</code>\u76EE\u5F55\u4E2D\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\u4EE5\u521D\u59CB\u5316\u9879\u76EE\u6587\u4EF6\u5939\u4E2D\u7684Git\u5B58\u50A8\u5E93</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> init
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0C\u5C06\u6240\u6709\u9879\u76EE\u6587\u4EF6\u6DFB\u52A0\u5230\u5B58\u50A8\u5E93\u4E2D</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u63D0\u4EA4\u66F4\u6539</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> commit -m <span class="token string">&#39;Initial commit for first deployment.&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u5C06\u60A8\u7684Git\u670D\u52A1\u5668\u6DFB\u52A0\u5230\u672C\u5730\u5B58\u50A8\u5E93\u3002\u8BF7\u786E\u4FDD\u4F7F\u7528\u60A8\u81EA\u5DF1\u7684\u8FDC\u7A0B\u5B58\u50A8\u5E93\u7684<strong>URL</strong>\u66FF\u6362\u547D\u4EE4\u4E2D\u7684\u5730\u5740\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> remote <span class="token function">add</span> origin git@mygitserver.com:username/repository.git
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5C06\u66F4\u6539\u63A8\u9001\u5230\u8FDC\u7A0BGit\u5B58\u50A8\u5E93\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> push origin master
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u4F7F\u7528\u4EE5\u4E0Bdep\u547D\u4EE4\u8FD0\u884C\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u4EE5\u4E0Bdep\u547D\u4EE4\u8FD0\u884C\u90E8\u7F72" aria-hidden="true">#</a> \u4F7F\u7528\u4EE5\u4E0B<code>dep</code>\u547D\u4EE4\u8FD0\u884C\u90E8\u7F72</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dep deploy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u9700\u8981\u67E5\u770B\u90E8\u7F72\u8F93\u51FA\u7684\u8BE6\u60C5\u53EF\u4EE5\u4F7F\u7528 <code>-vvv</code>\u53C2\u6570\u3002</p></blockquote><p>\u5982\u679C\u4E00\u5207\u987A\u5229\uFF0C\u4F60\u5E94\u8BE5Successfully deployed!\u5728\u6700\u540E\u770B\u5230\u8FD9\u6837\u7684\u8F93\u51FA</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Deployer&#39;s output
\u2708\uFE0E Deploying master on your_server_ip
\u2714 Executing task deploy:prepare
\u2714 Executing task deploy:lock
\u2714 Executing task deploy:release
\u27A4 Executing task deploy:update_code
\u2714 Ok
\u2714 Executing task deploy:shared
\u2714 Executing task deploy:vendors
\u2714 Executing task deploy:writable
\u2714 Executing task artisan:storage:link
\u2714 Executing task artisan:view:clear
\u2714 Executing task artisan:cache:clear
\u2714 Executing task artisan:config:cache
\u2714 Executing task artisan:optimize
\u2714 Executing task deploy:symlink
\u2714 Executing task deploy:unlock
\u2714 Executing task cleanup
Successfully deployed!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0B\u7ED3\u6784\u5C06\u5728\u76EE\u5F55\u5185\u7684\u670D\u52A1\u5668\u4E0A\u521B\u5EFA\uFF1A<code>/var/www/html/laravel-app</code></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u251C\u2500\u2500 .dep
\u251C\u2500\u2500 current -&gt; releases/1
\u251C\u2500\u2500 releases
\u2502   \u2514\u2500\u2500 1
\u2514\u2500\u2500 shared
    \u251C\u2500\u2500 .env
    \u2514\u2500\u2500 storage
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0B\u662F\u6BCF\u4E2A\u6587\u4EF6\u548C\u76EE\u5F55\u5305\u542B\u7684\u5185\u5BB9\uFF1A</p><ul><li>\u8BE5<code>releases</code>\u76EE\u5F55\u5305\u542BLaravel\u5E94\u7528\u7A0B\u5E8F\u7684\u90E8\u7F72\u7248\u672C\u3002</li><li><code>current</code> \u662F\u6700\u540E\u4E00\u4E2A\u7248\u672C\u7684\u7B26\u53F7\u94FE\u63A5\u3002</li><li>\u8BE5<code>.dep</code>\u76EE\u5F55\u5305\u542BDeployer\u7684\u7279\u6B8A\u5143\u6570\u636E\u3002</li><li>\u8BE5<code>shared</code>\u76EE\u5F55\u5305\u542B<code>.env</code>\u914D\u7F6E\u6587\u4EF6\u548C<code>storage</code>\u5C06\u88AB\u94FE\u63A5\u5230\u6BCF\u4E2A\u7248\u672C\u7684\u76EE\u5F55\u3002</li></ul><h3 id="\u767B\u5F55\u670D\u52A1\u5668" tabindex="-1"><a class="header-anchor" href="#\u767B\u5F55\u670D\u52A1\u5668" aria-hidden="true">#</a> \u767B\u5F55\u670D\u52A1\u5668</h3><h4 id="\u67E5\u770B\u9879\u76EE\u76EE\u5F55" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u9879\u76EE\u76EE\u5F55" aria-hidden="true">#</a> \u67E5\u770B\u9879\u76EE\u76EE\u5F55</h4><p>\u901A\u8FC7\u5728<strong>\u751F\u4EA7\u670D\u52A1\u5668</strong>\u4E0A\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\u6765\u9A8C\u8BC1\u8BE5\u6587\u4EF6\uFF0C\u8BE5\u547D\u4EE4\u5C06\u5217\u51FA\u6587\u4EF6\u5939\u4E2D\u7684\u6587\u4EF6\u548C\u76EE\u5F55\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ls</span> /var/www/html/laravel-app

<span class="token comment"># Output</span>
current  .dep  releases  shared
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F46\u662F\uFF0C\u8BE5\u5E94\u7528\u7A0B\u5E8F\u65E0\u6CD5\u5DE5\u4F5C\uFF0C\u56E0\u4E3A\u8BE5<code>.env</code>\u6587\u4EF6\u662F\u7A7A\u7684\u3002\u8BE5\u6587\u4EF6\u7528\u4E8E\u4FDD\u5B58\u91CD\u8981\u914D\u7F6E\uFF0C\u5982\u5E94\u7528\u7A0B\u5E8F\u5BC6\u94A5<code>APP_KEY</code>\u7528\u4E8E\u52A0\u5BC6\u7684\u968F\u673A\u5B57\u7B26\u4E32\u3002\u5982\u679C\u672A\u8BBE\u7F6E\uFF0C\u60A8\u7684\u7528\u6237\u4F1A\u8BDD\u548C\u5176\u4ED6\u52A0\u5BC6\u6570\u636E\u5C06\u4E0D\u5B89\u5168\u3002</p><p>\u8BE5\u5E94\u7528\u7A0B\u5E8F<code>.env</code>\u5728\u672C\u5730\u8BA1\u7B97\u673A\u4E0A\u6709\u4E00\u4E2A\u6587\u4EF6\uFF0C\u4F46Laravel\u7684<code>.gitignore</code>\u6587\u4EF6\u5C06\u5176\u4ECEGit\u4E2D\u6392\u9664\uFF0C\u56E0\u4E3A\u5C06\u5BC6\u7801\u7B49\u654F\u611F\u6570\u636E\u5B58\u50A8\u5728Git\u5B58\u50A8\u5E93\u4E2D\u5E76\u4E0D\u662F\u4E00\u4E2A\u6700\u4F73\u5B9E\u8DF5\uFF0C\u800C\u4E14\u8BE5\u5E94\u7528\u7A0B\u5E8F\u5728\u60A8\u7684\u670D\u52A1\u5668\u4E0A\u9700\u8981\u4E0D\u540C\u7684\u8BBE\u7F6E\u3002</p><p>\u53E6\u5916\u8BE5<code>.env</code>\u6587\u4EF6\u4E5F\u5305\u542B\u6570\u636E\u5E93\u8FDE\u63A5\u8BBE\u7F6E\uFF0C\u8FD9\u5C31\u662F\u4E3A\u4EC0\u4E48\u6211\u4EEC\u7981\u7528\u7B2C\u4E00\u6B21\u90E8\u7F72\u7684\u6570\u636E\u5E93\u8FC1\u79FB\u7684\u539F\u56E0\u3002</p><h4 id="\u914D\u7F6E\u9879\u76EE\u73AF\u5883\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u914D\u7F6E\u9879\u76EE\u73AF\u5883\u53D8\u91CF" aria-hidden="true">#</a> \u914D\u7F6E\u9879\u76EE\u73AF\u5883\u53D8\u91CF</h4><p>\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4\uFF0C\u4ECE\u5F00\u53D1\u673A\u5668\u4E0A\u4EE5<strong>\u90E8\u7F72\u8005\u7528\u6237</strong>\u8EAB\u4EFD\u767B\u5F55\u5230\u60A8\u7684\u670D\u52A1\u5668\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ssh</span> deployer@your_server_ip  -i ~/.ssh/deployerkey
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u751F\u4EA7\u670D\u52A1\u5668\u4E0A\u4FEE\u6539<code>.env</code>\u73AF\u5883\u914D\u7F6E\u6587\u4EF6<code>vim /var/www/html/laravel-app/shared/.env</code>\u5185\u5BB9\uFF1A</p><div class="language-dotenv ext-dotenv line-numbers-mode"><pre class="language-dotenv"><code>APP_NAME=laravel-app
APP_ENV=production
APP_KEY=base64:SXYMVQIW2hyl8lc+x0UZw5fxMNoEv0fPzhten9lBjUQ=
APP_DEBUG=false
APP_URL=http://example.com

LOG_CHANNEL=stack

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=laravel_app
DB_USERNAME=laravel_user
DB_PASSWORD=password

BROADCAST_DRIVER=log
CACHE_DRIVER=file
SESSION_DRIVER=file
SESSION_LIFETIME=120
QUEUE_DRIVER=sync

REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_DRIVER=smtp
MAIL_HOST=smtp.mailtrap.io
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null

PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1

MIX_PUSHER_APP_KEY=&quot;\${PUSHER_APP_KEY}&quot;
MIX_PUSHER_APP_CLUSTER=&quot;\${PUSHER_APP_CLUSTER}&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FDD\u5B58\u8BE5\u6587\u4EF6\u5E76\u5173\u95ED\u7F16\u8F91\u5668\u3002</p><p>\u73B0\u5728\u53D6\u6D88\u6CE8\u91CA<code>deploy.php</code>\u672C\u5730\u673A\u5668\u4E0A\u6587\u4EF6\u4E2D\u5173\u4E8E<code>before(&#39;deploy:symlink&#39;, &#39;artisan:migrate&#39;);</code>\uFF1A</p><blockquote><p>\u8FD9\u4E2A\u64CD\u4F5C\u4F1A\u5BFC\u81F4\u6570\u636E\u5E93\u8FC1\u79FB\u5728\u6BCF\u4E2A\u90E8\u7F72\u4E2D\u81EA\u52A8\u8FD0\u884C\u3002\u8FD9\u6837\u53EF\u4EE5\u907F\u514D\u624B\u52A8\u8FC1\u79FB\u6570\u636E\u5E93\uFF0C\u4F46\u5728\u90E8\u7F72\u4E4B\u524D\u4E0D\u8981\u5FD8\u8BB0\u5907\u4EFD\u6570\u636E\u5E93\u3002</p></blockquote><p>\u8981\u68C0\u67E5\u6B64\u914D\u7F6E\u662F\u5426\u6B63\u5E38\uFF0C\u8BF7\u518D\u6B21\u90E8\u7F72\u8BE5\u5E94\u7528\u7A0B\u5E8F\u3002\u5728<strong>\u672C\u5730\u5F00\u53D1\u673A\u5668</strong>\u4E0A\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dep deploy -vvv
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u73B0\u5728\uFF0C\u60A8\u7684\u5E94\u7528\u7A0B\u5E8F\u5C06\u6B63\u5E38\u5DE5\u4F5C\u3002\u5982\u679C\u60A8\u8BBF\u95EE\u670D\u52A1\u5668\u7684\u57DF\u540D\uFF08<code>http://example.com</code>\uFF09\uFF0C\u60A8\u5C06\u770B\u5230\u4EE5\u4E0B\u767B\u5F55\u9875\u9762\uFF1A</p>`,40),fn=["src"],xn=i(`<p>\u5F53\u914D\u7F6E\u5B8C\u4E0A\u9762\u7684\u914D\u7F6E\u4E4B\u540E\uFF0C\u6BCF\u6B21\u5F00\u53D1\u573A\u666F\u4E0D\u9700\u8981\u5982\u6B64\u590D\u6742\u7684\u64CD\u4F5C\u3002</p><h2 id="\u8FD0\u884C\u5178\u578B\u90E8\u7F72" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u5178\u578B\u90E8\u7F72" aria-hidden="true">#</a> \u8FD0\u884C\u5178\u578B\u90E8\u7F72</h2><p>\u5728\u518D\u6B21\u90E8\u7F72\u4E4B\u524D\uFF0C\u901A\u8FC7\u4FEE\u6539\u5E94\u7528\u7A0B\u5E8F\u5F00\u59CB\u3002\u4F8B\u5982\uFF0C\u60A8\u53EF\u4EE5\u5728<code>routes/web.php</code>\u6587\u4EF6\u4E2D\u6DFB\u52A0\u65B0\u7684<code>about</code>\u8DEF\u7531\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;welcome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Route</span><span class="token operator">::</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;/about&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string single-quoted-string">&#39;About Page&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FDD\u5B58\u6587\u4EF6\u5E76\u63D0\u4EA4\u8FD9\u4E9B\u66F4\u6539\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> commit -am <span class="token string">&#39;Your commit message.&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5C06\u66F4\u6539\u63A8\u9001\u5230\u8FDC\u7A0BGit\u5B58\u50A8\u5E93</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> push origin master
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u90E8\u7F72\u5E94\u7528\u7A0B\u5E8F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>dep deploy
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="\u7ED3\u8BBA" tabindex="-1"><a class="header-anchor" href="#\u7ED3\u8BBA" aria-hidden="true">#</a> \u7ED3\u8BBA</h2>`,11),wn=s("\u901A\u8FC7\u914D\u7F6E\u672C\u5730\u5F00\u53D1\u673A\u5668\u548C\u751F\u6210\u73AF\u5883\u670D\u52A1\u5668\uFF0C\u4EE5\u96F6\u5B95\u673A\u65F6\u95F4\u8F7B\u677E\u90E8\u7F72Laravel\u5E94\u7528\u7A0B\u5E8F\u3002"),Sn=n("strong",null,"\u90E8\u7F72\u8005",-1),En=s("\u8FD8\u53EF\u4EE5\u4E00\u6B21\u90E8\u7F72\u5230\u66F4\u591A\u670D\u52A1\u5668\u5E76\u521B\u5EFA\u4EFB\u52A1; \u4F8B\u5982\uFF0C\u53EF\u4EE5\u6307\u5B9A\u4E00\u4E2A\u4EFB\u52A1\u6765\u5728\u8FC1\u79FB\u4E4B\u524D\u5907\u4EFD\u6570\u636E\u5E93\u3002\u5982\u679C\u60F3\u4E86\u89E3\u5173\u4E8E\u90E8\u7F72\u8005\u529F\u80FD\u7684\u66F4\u591A\u4FE1\u606F\uFF0C\u53EF\u4EE5\u5728** \u90E8\u7F72\u8005**"),qn={href:"https://deployer.org/docs/tasks",target:"_blank",rel:"noopener noreferrer"},Pn=s("\u6587\u6863"),An=s("\u4E2D\u627E\u5230\u66F4\u591A\u4FE1\u606F\u3002"),Ln=n("h2",{id:"\u53C2\u8003\u94FE\u63A5",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u53C2\u8003\u94FE\u63A5","aria-hidden":"true"},"#"),s(" \u53C2\u8003\u94FE\u63A5")],-1),Hn={href:"https://www.digitalocean.com/community/tutorials/automatically-deploy-laravel-applications-deployer-ubuntu#conclusion",target:"_blank",rel:"noopener noreferrer"},Rn=s("\u5982\u4F55\u5728Ubuntu 16.04\u4E0A\u4F7F\u7528Deployer\u81EA\u52A8\u90E8\u7F72Laravel\u5E94\u7528\u7A0B\u5E8F"),Dn={href:"https://laravel-china.org/articles/13242/another-introduction-to-the-use-of-deployer",target:"_blank",rel:"noopener noreferrer"},Gn=s("\u53C8\u4E00\u7BC7 Deployer \u7684\u4F7F\u7528\u653B\u7565"),In={href:"https://juejin.im/entry/5afd3dd051882542821c87d3",target:"_blank",rel:"noopener noreferrer"},Nn=s("deployer \u5B9E\u6218\u7ECF\u9A8C\u5206\u4EAB"),Tn={href:"https://juejin.im/entry/58fd79d961ff4b00666c2e95",target:"_blank",rel:"noopener noreferrer"},On=s("\u5C11\u5E74\uFF0C\u662F\u65F6\u5019\u6362\u79CD\u66F4\u4F18\u96C5\u7684\u65B9\u5F0F\u90E8\u7F72\u4F60\u7684 php \u4EE3\u7801\u4E86");function Un(t,Mn){const a=l("ExternalLinkIcon"),o=l("RouterLink");return c(),r(u,null,[m,n("p",null,[n("a",h,[b,e(a)]),g,n("a",k,[_,e(a)]),y,f,x,w,S,E,q,P,A]),n("p",null,[L,n("a",H,[R,e(a)]),D]),G,I,n("ul",null,[N,n("li",null,[T,e(o,{to:"/os/ubuntu/ubuntu-quickly-build-lnmp-environment.html"},{default:p(()=>[O]),_:1}),U]),n("li",null,[M,n("a",C,[B,e(a)]),F,n("a",Y,[V,e(a)]),z,n("a",j,[Q,e(a)]),W,n("a",X,[$,e(a)]),K,J,Z,nn,sn,en,an,ln,tn]),on,dn]),cn,n("ul",null,[n("li",null,[n("a",rn,[pn,e(a)])]),n("li",null,[n("a",un,[vn,e(a)])]),n("li",null,[n("a",mn,[hn,e(a)])])]),bn,n("p",null,[gn,n("a",kn,[_n,e(a)])]),yn,n("img",{src:t.$withBase("/images/os/ubuntu/automatically-deploy-laravel-applications-deployer-ubuntu/deployerimg.png"),alt:""},null,8,fn),xn,n("p",null,[wn,Sn,En,n("a",qn,[Pn,e(a)]),An]),Ln,n("ul",null,[n("li",null,[n("a",Hn,[Rn,e(a)])]),n("li",null,[n("a",Dn,[Gn,e(a)])]),n("li",null,[n("a",In,[Nn,e(a)])]),n("li",null,[n("a",Tn,[On,e(a)])])])],64)}var Bn=d(v,[["render",Un],["__file","automatically-deploy-laravel-applications-deployer-ubuntu.html.vue"]]);export{Bn as default};
