import{_ as r,M as t,p as c,q as l,R as s,t as a,N as n,V as d,a1 as o}from"./framework-96b046e1.js";const i="/blog/assets/ps-and-netstat-check-shadowsocks-status-bf473db8.png",u={},h=s("h1",{id:"centos7下安装配置-shadowsocks",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#centos7下安装配置-shadowsocks","aria-hidden":"true"},"#"),a(" CentOS7下安装配置 shadowsocks")],-1),k={href:"https://github.com/shadowsocks/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/shadowsocks/shadowsocks-windows/wiki/Shadowsocks-Windows-%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"},b={href:"https://github.com/shadowsocks/ShadowsocksX-NG",target:"_blank",rel:"noopener noreferrer"},m={href:"https://github.com/shadowsocks/shadowsocks-android",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/shadowsocks/shadowsocks-iOS/wiki/Help",target:"_blank",rel:"noopener noreferrer"},_=s("code",null,"OpenWingy",-1),f=s("h2",{id:"安装",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#安装","aria-hidden":"true"},"#"),a(" 安装")],-1),q=s("h3",{id:"安装epel和pip",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#安装epel和pip","aria-hidden":"true"},"#"),a(" 安装epel和pip")],-1),w=s("p",null,"安装epel扩展源，并采用Python包管理工pip安装。",-1),y={href:"https://pip.pypa.io/en/stable/installing/",target:"_blank",rel:"noopener noreferrer"},x=o(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> epel-release
<span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> python-pip
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="安装shadowsocks" tabindex="-1"><a class="header-anchor" href="#安装shadowsocks" aria-hidden="true">#</a> 安装Shadowsocks</h3><p>在命令行运行下面的命令安装shadowsocks：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> <span class="token parameter variable">--upgrade</span> pip
pip <span class="token function">install</span> shadowsocks
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置" tabindex="-1"><a class="header-anchor" href="#配置" aria-hidden="true">#</a> 配置</h2><h3 id="普通配置" tabindex="-1"><a class="header-anchor" href="#普通配置" aria-hidden="true">#</a> 普通配置</h3><p>安装完成后，需要创建配置文件<code>/etc/shadowsocks.json</code>，内容如下：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;server_port&quot;</span><span class="token operator">:</span> <span class="token number">1111</span><span class="token punctuation">,</span>
  <span class="token property">&quot;local_address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;local_port&quot;</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mypassword&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timeout&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aes-256-cfb&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;fast_open&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>字段</th><th>说明</th><th>是否必须</th></tr></thead><tbody><tr><td>server</td><td>服务端监听地址，使用<code>0.0.0.0</code>也可以</td><td>是</td></tr><tr><td>server_port</td><td>服务端端口</td><td>是</td></tr><tr><td>local_address</td><td>本地监听地址,默认即可</td><td>否</td></tr><tr><td>local_port</td><td>本地监听端口，需要跟其他进程不重复</td><td>否</td></tr><tr><td>password</td><td>密码</td><td>是</td></tr><tr><td>timeout</td><td>超时时间（秒）</td><td>否</td></tr><tr><td>method</td><td>加密方法，可选<code>aes-128-cfb</code>, <code>aes-192-cfb</code>, <code>aes-256-cfb</code>, <code>bf-cfb</code>, <code>cast5-cfb</code>, <code>des-cfb</code>, <code>rc4-md5</code>, <code>chacha20</code>, <code>salsa20</code>, <code>rc4</code>, <code>table</code></td><td>是</td></tr><tr><td>fast_open</td><td>是否启用TCP-Fast-Open，true或者false</td><td>否</td></tr></tbody></table><blockquote><p>以上三项信息在配置 shadowsocks 客户端时需要配置一致，具体说明可查看 shadowsocks 的帮助文档。</p></blockquote><h3 id="配置多个用户" tabindex="-1"><a class="header-anchor" href="#配置多个用户" aria-hidden="true">#</a> 配置多个用户</h3><p>除了上面的配置，也可能使用多端口多密码配置，彼此没有干扰，内容如下：</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;local_address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;local_port&quot;</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span>
  <span class="token property">&quot;port_password&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;1111&quot;</span><span class="token operator">:</span> <span class="token string">&quot;password1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;1112&quot;</span><span class="token operator">:</span> <span class="token string">&quot;password2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;1113&quot;</span><span class="token operator">:</span> <span class="token string">&quot;password3&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timeout&quot;</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aes-256-cfb&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;fast_open&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="进程管理" tabindex="-1"><a class="header-anchor" href="#进程管理" aria-hidden="true">#</a> 进程管理</h2><ul><li>启动进程</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> ssserver <span class="token parameter variable">-c</span> /etc/shadowsocks.json <span class="token parameter variable">-d</span> start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>关闭进程</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> ssserver <span class="token parameter variable">-c</span> /etc/shadowsocks.json <span class="token parameter variable">-d</span> stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>重启进程</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> ssserver <span class="token parameter variable">-c</span> /etc/shadowsocks.json <span class="token parameter variable">-d</span> restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="检查进程" tabindex="-1"><a class="header-anchor" href="#检查进程" aria-hidden="true">#</a> 检查进程</h2><p>分别使用<code>ps</code>和<code>netstat</code>命令查看进程和端口</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> net-tools
<span class="token function">ps</span> aux <span class="token operator">|</span><span class="token function">grep</span> shadowsocks
<span class="token function">netstat</span> -tunpl<span class="token operator">|</span><span class="token function">grep</span> <span class="token number">1111</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+i+'" alt=""></p><h2 id="使用supervisord管理进程" tabindex="-1"><a class="header-anchor" href="#使用supervisord管理进程" aria-hidden="true">#</a> 使用Supervisord管理进程</h2>',25),S=o(`<h3 id="管理配置" tabindex="-1"><a class="header-anchor" href="#管理配置" aria-hidden="true">#</a> 管理配置</h3><p>针对shadowsocks的Supervisord的配置可以参考下面的配置。</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">program:shadowsocks</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">process_name</span> <span class="token punctuation">=</span> <span class="token value attr-value">%(program_name)s_%(process_num)02d</span>
<span class="token key attr-name">command</span> <span class="token punctuation">=</span> <span class="token value attr-value">ssserver -c /etc/shadowsocks.json</span>
<span class="token key attr-name">autostart</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">autorestart</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">user</span> <span class="token punctuation">=</span> <span class="token value attr-value">nobody</span>
<span class="token key attr-name">numprocs</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">redirect_stderr</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">stdout_logfile</span> <span class="token punctuation">=</span> <span class="token value attr-value">/var/log/shdowsocks.out.log</span>
<span class="token key attr-name">stderr_logfile</span> <span class="token punctuation">=</span> <span class="token value attr-value">/var/log/shdowsocks.err.log</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重载配置" tabindex="-1"><a class="header-anchor" href="#重载配置" aria-hidden="true">#</a> 重载配置</h3><p>重载配置之前请先保证shadowsocks进程未启动。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> supervisorctl reread <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> supervisorctl update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接" aria-hidden="true">#</a> 参考链接</h2>`,7),j={href:"https://morning.work/page/2015-12/install-shadowsocks-on-centos-7.html",target:"_blank",rel:"noopener noreferrer"},C={href:"https://segmentfault.com/a/1190000010639190",target:"_blank",rel:"noopener noreferrer"};function E(O,B){const e=t("ExternalLinkIcon"),p=t("RouterLink");return c(),l("div",null,[h,s("p",null,[s("a",k,[a("Shadowsocks"),n(e)]),a("是当前比较受欢迎的科学上网工具，本文将介绍如何在 CentOS 7下安装和配置 Shadowsocks 服务。")]),s("blockquote",null,[s("p",null,[a("如果需要科学上网，当前服务器必须不在墙内，否则无法达到预期效果。 本文只介绍了服务器安装Shadowsocks和简单配置。如果要在客户端正常使用可能还需要一些代理软件。比如："),s("a",v,[a("Windows"),n(e)]),a("、"),s("a",b,[a("MacOSX"),n(e)]),a("、"),s("a",m,[a("Android"),n(e)]),a("、"),s("a",g,[a("IOS"),n(e)]),a("或者使用AppStore搜索"),_,a("这个软件。")])]),f,q,w,s("p",null,[s("a",y,[a("pip"),n(e)]),a("是 python 的包管理工具。在本文中将使用 python 版本的 shadowsocks，此版本的 shadowsocks 已发布到 pip 上，因此需要通过 pip 命令来安装。")]),x,s("p",null,[a("如果未使用"),n(p,{to:"/os/centos/how-to-use-supervisord-manager-processes.html"},{default:d(()=>[a("Supervisord管理")]),_:1}),a("后台进程，可以参考文章下面的连接设置开机自启动等。")]),S,s("ul",null,[s("li",null,[s("p",null,[s("a",j,[a("在 CentOS 7 下安装配置 shadowsocks"),n(e)])])]),s("li",null,[s("p",null,[s("a",C,[a("阿里云centos 7下搭建shadowsocks"),n(e)])])])])])}const V=r(u,[["render",E],["__file","installing-configuration-shadowsocks-under-centos-7.html.vue"]]);export{V as default};
